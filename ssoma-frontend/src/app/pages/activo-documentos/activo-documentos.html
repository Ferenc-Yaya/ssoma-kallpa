<div class="activo-documentos-container">
  <!-- Breadcrumb -->
  <div class="breadcrumb">
    <a [routerLink]="['/empresas']">
      <mat-icon>business</mat-icon>
      Empresas
    </a>
    <mat-icon class="separator">chevron_right</mat-icon>
    <a [routerLink]="['/empresas', empresaId]">
      Empresa
    </a>
    <mat-icon class="separator">chevron_right</mat-icon>
    <a [routerLink]="['/empresas', empresaId, 'activos']">
      Activos
    </a>
    <mat-icon class="separator">chevron_right</mat-icon>
    <span class="current">Documentos</span>
  </div>

  <!-- Header con información del activo -->
  <mat-card class="activo-card" *ngIf="activo">
    <div class="activo-header">
      <mat-icon class="activo-icon">
        {{ activo.tipo_activo === 'VEHICULO' ? 'directions_car' : 'build' }}
      </mat-icon>
      <div class="activo-info">
        <h2>{{ activo.descripcion }}</h2>
        <p class="activo-datos">
          <mat-icon>{{ activo.tipo_activo === 'VEHICULO' ? 'badge' : 'qr_code' }}</mat-icon>
          {{ activo.tipo_activo === 'VEHICULO' ? 'Placa: ' + activo.placa : 'Serie: ' + activo.serie }}
        </p>
        <p class="activo-datos">
          <mat-icon>business</mat-icon>
          {{ activo.marca }} - {{ activo.modelo }}
        </p>
      </div>
      <div class="activo-estado">
        <div class="status-chip" [ngClass]="'chip-' + activo.estado.toLowerCase()">
          <mat-icon class="chip-icon">
            {{ activo.estado === 'OPERATIVO' ? 'check_circle' :
               activo.estado === 'MANTENIMIENTO' ? 'build_circle' :
               'cancel' }}
          </mat-icon>
          <span>{{ activo.estado }}</span>
        </div>
      </div>
    </div>
  </mat-card>

  <!-- Documentos por categoría -->
  <div class="categorias-container" *ngIf="documentosCargados">
    <mat-card class="categoria-card" *ngFor="let categoria of categorias">
      <mat-card-header [style.background-color]="getCategoriaColor(categoria)">
        <mat-card-title>
          <mat-icon>{{ getCategoriaIcon(categoria) }}</mat-icon>
          {{ categoria }}
        </mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <div class="documentos-list">
          <ng-container *ngIf="getDocumentosPorCategoria(categoria) as docsCategoria">
            <div class="documento-item" *ngFor="let doc of docsCategoria">
              <div class="documento-info">
                <mat-icon class="doc-icon">description</mat-icon>
                <div class="doc-details">
                  <div class="doc-nombre-row">
                    <span class="doc-nombre">{{ doc.nombre }}</span>
                    <mat-icon class="obligatorio-icon" *ngIf="doc.obligatorio" matTooltip="Documento obligatorio" color="warn">
                      priority_high
                    </mat-icon>
                  </div>
                  <span class="doc-estado" *ngIf="doc.archivo">
                    <mat-icon class="status-icon">check_circle</mat-icon>
                    Subido
                  </span>
                  <span class="doc-estado sin-archivo" *ngIf="!doc.archivo">
                    <mat-icon class="status-icon">cloud_upload</mat-icon>
                    Pendiente {{ doc.obligatorio ? '(Obligatorio)' : '' }}
                  </span>
                </div>
              </div>

              <div class="documento-acciones">
                <button mat-raised-button color="primary" (click)="subirDocumento(doc)">
                  <mat-icon>upload</mat-icon>
                  {{ doc.archivo ? 'Reemplazar' : 'Subir' }}
                </button>
                <button mat-icon-button *ngIf="doc.archivo" (click)="verDocumento(doc)" matTooltip="Ver documento">
                  <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button *ngIf="doc.archivo" (click)="eliminarDocumento(doc)" color="warn" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>

            <div class="sin-documentos" *ngIf="docsCategoria.length === 0">
              <mat-icon>info</mat-icon>
              <p>No hay documentos requeridos en esta categoría</p>
            </div>
          </ng-container>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
