<div class="personal-documentos-container">
  <!-- Breadcrumb -->
  <div class="breadcrumb">
    <a [routerLink]="['/empresas']">
      <mat-icon>business</mat-icon>
      Empresas
    </a>
    <mat-icon class="separator">chevron_right</mat-icon>
    <a [routerLink]="['/empresas', empresaId]" *ngIf="empresaId">
      Empresa
    </a>
    <mat-icon class="separator">chevron_right</mat-icon>
    <a [routerLink]="['/empresas', empresaId, 'personal']" *ngIf="empresaId">
      Personal
    </a>
    <mat-icon class="separator">chevron_right</mat-icon>
    <span class="current">Documentos</span>
  </div>

  <!-- Header con información de la persona -->
  <mat-card class="persona-card" *ngIf="persona">
    <div class="persona-header">
      <img [src]="persona.foto || 'https://i.pravatar.cc/300?img=1'"
           [alt]="persona.nombres"
           class="persona-foto">
      <div class="persona-info">
        <h2>{{ persona.nombres }} {{ persona.apellidos }}</h2>
        <p class="persona-datos">
          <mat-icon>badge</mat-icon>
          {{ persona.tipo_documento }}: {{ persona.numero_documento }}
        </p>
        <p class="persona-datos">
          <mat-icon>work</mat-icon>
          {{ persona.cargo }}
        </p>
      </div>
      <div class="persona-estado">
        <div class="status-chip" [ngClass]="'chip-' + persona.estado_acreditacion.toLowerCase()">
          <mat-icon class="chip-icon">
            {{ persona.estado_acreditacion === 'APTO' ? 'check_circle' :
               persona.estado_acreditacion === 'OBSERVADO' ? 'cancel' :
               'schedule' }}
          </mat-icon>
          <span>{{ persona.estado_acreditacion }}</span>
        </div>
      </div>
    </div>
  </mat-card>

  <!-- Documentos por categoría -->
  <div class="categorias-container" *ngIf="documentosCargados">
    <mat-card class="categoria-card" *ngFor="let categoria of categorias">
      <mat-card-header [style.background-color]="getCategoriaColor(categoria)">
        <mat-card-title>
          <mat-icon>{{ getCategoriaIcon(categoria) }}</mat-icon>
          {{ categoria }}
        </mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <div class="documentos-list">
          <ng-container *ngIf="getDocumentosPorCategoria(categoria) as docsCategoria">
            <div class="documento-item" *ngFor="let doc of docsCategoria">
              <div class="documento-info">
                <mat-icon class="doc-icon">description</mat-icon>
                <div class="doc-details">
                  <div class="doc-nombre-row">
                    <span class="doc-nombre">{{ doc.nombre }}</span>
                    <mat-icon class="obligatorio-icon" *ngIf="doc.obligatorio" matTooltip="Documento obligatorio" color="warn">
                      priority_high
                    </mat-icon>
                  </div>
                  <span class="doc-estado" *ngIf="doc.archivo">
                    <mat-icon class="status-icon">check_circle</mat-icon>
                    Subido
                  </span>
                  <span class="doc-estado sin-archivo" *ngIf="!doc.archivo">
                    <mat-icon class="status-icon">cloud_upload</mat-icon>
                    Pendiente {{ doc.obligatorio ? '(Obligatorio)' : '' }}
                  </span>
                </div>
              </div>

              <div class="documento-acciones">
                <button mat-raised-button color="primary" (click)="subirDocumento(doc)">
                  <mat-icon>upload</mat-icon>
                  {{ doc.archivo ? 'Reemplazar' : 'Subir' }}
                </button>
                <button mat-icon-button *ngIf="doc.archivo" (click)="verDocumento(doc)" matTooltip="Ver documento">
                  <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button *ngIf="doc.archivo" (click)="eliminarDocumento(doc)" color="warn" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>

            <div class="sin-documentos" *ngIf="docsCategoria.length === 0">
              <mat-icon>info</mat-icon>
              <p>No hay documentos requeridos en esta categoría</p>
            </div>
          </ng-container>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
