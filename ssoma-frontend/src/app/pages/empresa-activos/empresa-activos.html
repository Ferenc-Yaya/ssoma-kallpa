<div class="empresa-activos-page">
  <!-- Header -->
  <div class="page-header">
    <button mat-icon-button class="btn-volver" (click)="volver()">
      <mat-icon>arrow_back</mat-icon>
    </button>

    <div class="header-content" *ngIf="empresa">
      <div class="header-info">
        <h1>
        <mat-icon>inventory_2</mat-icon>
        Activos de {{ empresa.razonSocial }}
        </h1>
        <p>Gestión de vehículos y herramientas</p>
      </div>

      <div class="header-stats">
        <div class="stat-card">
          <mat-icon>directions_car</mat-icon>
          <div class="stat-info">
            <span class="stat-value">{{ vehiculos.length }}</span>
            <span class="stat-label">Vehículos</span>
          </div>
        </div>
        <div class="stat-card">
          <mat-icon>build</mat-icon>
          <div class="stat-info">
            <span class="stat-value">{{ herramientas.length }}</span>
            <span class="stat-label">Herramientas</span>
          </div>
        </div>
        <div class="stat-card">
          <mat-icon>inventory</mat-icon>
          <div class="stat-info">
            <span class="stat-value">{{ activos.length }}</span>
            <span class="stat-label">Total</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <mat-tab-group class="activos-tabs">
    <!-- TAB 1: VEHÍCULOS -->
    <mat-tab>
      <ng-template mat-tab-label>
        <mat-icon>directions_car</mat-icon>
        Vehículos ({{ vehiculos.length }})
      </ng-template>

      <div class="tab-content">
        <div class="tab-header">
          <h2>Vehículos registrados</h2>
          <button mat-raised-button color="primary" (click)="agregarActivo('VEHICULO')">
            <mat-icon>add</mat-icon>
            Agregar Vehículo
          </button>
        </div>

        <div class="table-container" *ngIf="vehiculos.length > 0">
          <table mat-table [dataSource]="vehiculos" class="activos-table">
            <!-- Placa -->
            <ng-container matColumnDef="codigo">
              <th mat-header-cell *matHeaderCellDef>Placa</th>
              <td mat-cell *matCellDef="let activo">
                <strong>{{ activo.placa }}</strong>
              </td>
            </ng-container>

            <!-- Descripción -->
            <ng-container matColumnDef="descripcion">
              <th mat-header-cell *matHeaderCellDef>Descripción</th>
              <td mat-cell *matCellDef="let activo">{{ activo.descripcion }}</td>
            </ng-container>

            <!-- Marca -->
            <ng-container matColumnDef="marca">
              <th mat-header-cell *matHeaderCellDef>Marca</th>
              <td mat-cell *matCellDef="let activo">{{ activo.marca }}</td>
            </ng-container>

            <!-- Modelo -->
            <ng-container matColumnDef="modelo">
              <th mat-header-cell *matHeaderCellDef>Modelo</th>
              <td mat-cell *matCellDef="let activo">{{ activo.modelo }}</td>
            </ng-container>

            <!-- Estado -->
            <ng-container matColumnDef="estado">
              <th mat-header-cell *matHeaderCellDef>Estado</th>
              <td mat-cell *matCellDef="let activo">
                <div class="custom-chip" [style.background-color]="getEstadoColor(activo.estado)">
                  {{ activo.estado }}
                </div>
              </td>
            </ng-container>

            <!-- Documentos -->
            <ng-container matColumnDef="documentos">
              <th mat-header-cell *matHeaderCellDef>Documentos</th>
              <td mat-cell *matCellDef="let activo">
                <div class="docs-status">
                  <span class="doc-vigente">✓ {{ activo.documentos_vigentes }}</span>
                  <span class="doc-vencido" *ngIf="activo.documentos_vencidos > 0">
                    ✗ {{ activo.documentos_vencidos }}
                  </span>
                </div>
              </td>
            </ng-container>

            <!-- Acciones -->
            <ng-container matColumnDef="acciones">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let activo">
                <div class="actions">
                  <button mat-icon-button color="primary" (click)="editarActivo(activo)" matTooltip="Editar">
                    <mat-icon>edit</mat-icon>
                  </button>
                  <button mat-icon-button color="warn" (click)="eliminarActivo(activo)" matTooltip="Eliminar">
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>

        <div class="empty-state" *ngIf="vehiculos.length === 0">
          <mat-icon>directions_car</mat-icon>
          <h3>No hay vehículos registrados</h3>
          <p>Agrega el primer vehículo de esta empresa</p>
          <button mat-raised-button color="primary" (click)="agregarActivo('VEHICULO')">
            <mat-icon>add</mat-icon>
            Agregar Vehículo
          </button>
        </div>
      </div>
    </mat-tab>

    <!-- TAB 2: HERRAMIENTAS -->
    <mat-tab>
      <ng-template mat-tab-label>
        <mat-icon>build</mat-icon>
        Herramientas ({{ herramientas.length }})
      </ng-template>

      <div class="tab-content">
        <div class="tab-header">
          <h2>Herramientas registradas</h2>
          <button mat-raised-button color="primary" (click)="agregarActivo('HERRAMIENTA')">
            <mat-icon>add</mat-icon>
            Agregar Herramienta
          </button>
        </div>

        <div class="table-container" *ngIf="herramientas.length > 0">
          <table mat-table [dataSource]="herramientas" class="activos-table">
            <!-- Serie -->
            <ng-container matColumnDef="codigo">
              <th mat-header-cell *matHeaderCellDef>Serie</th>
              <td mat-cell *matCellDef="let activo">
                <strong>{{ activo.serie }}</strong>
              </td>
            </ng-container>

            <!-- Descripción -->
            <ng-container matColumnDef="descripcion">
              <th mat-header-cell *matHeaderCellDef>Descripción</th>
              <td mat-cell *matCellDef="let activo">{{ activo.descripcion }}</td>
            </ng-container>

            <!-- Marca -->
            <ng-container matColumnDef="marca">
              <th mat-header-cell *matHeaderCellDef>Marca</th>
              <td mat-cell *matCellDef="let activo">{{ activo.marca }}</td>
            </ng-container>

            <!-- Modelo -->
            <ng-container matColumnDef="modelo">
              <th mat-header-cell *matHeaderCellDef>Modelo</th>
              <td mat-cell *matCellDef="let activo">{{ activo.modelo }}</td>
            </ng-container>

            <!-- Estado -->
            <ng-container matColumnDef="estado">
              <th mat-header-cell *matHeaderCellDef>Estado</th>
              <td mat-cell *matCellDef="let activo">
                <div class="custom-chip" [style.background-color]="getEstadoColor(activo.estado)">
                  {{ activo.estado }}
                </div>
              </td>
            </ng-container>

            <!-- Documentos -->
            <ng-container matColumnDef="documentos">
              <th mat-header-cell *matHeaderCellDef>Documentos</th>
              <td mat-cell *matCellDef="let activo">
                <div class="docs-status">
                  <span class="doc-vigente">✓ {{ activo.documentos_vigentes }}</span>
                  <span class="doc-vencido" *ngIf="activo.documentos_vencidos > 0">
                    ✗ {{ activo.documentos_vencidos }}
                  </span>
                </div>
              </td>
            </ng-container>

            <!-- Acciones -->
            <ng-container matColumnDef="acciones">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let activo">
                <div class="actions">
                  <button mat-icon-button color="primary" (click)="editarActivo(activo)" matTooltip="Editar">
                    <mat-icon>edit</mat-icon>
                  </button>
                  <button mat-icon-button color="warn" (click)="eliminarActivo(activo)" matTooltip="Eliminar">
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>

        <div class="empty-state" *ngIf="herramientas.length === 0">
          <mat-icon>build</mat-icon>
          <h3>No hay herramientas registradas</h3>
          <p>Agrega la primera herramienta de esta empresa</p>
          <button mat-raised-button color="primary" (click)="agregarActivo('HERRAMIENTA')">
            <mat-icon>add</mat-icon>
            Agregar Herramienta
          </button>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>