<div class="empresa-principal">
  <div class="page-header">
    <div class="header-content">
      <div>
        <h1>Empresas Principales (Multi-Tenant)</h1>
        <p class="subtitle">Gestión de empresas principales y sus configuraciones de tenant</p>
      </div>
      <button mat-raised-button color="primary" (click)="openEmpresaDialog()">
        <mat-icon>add_business</mat-icon>
        Nueva Empresa Principal
      </button>
    </div>
  </div>

  <!-- Lista de Empresas Principales -->
  <div class="empresas-list" *ngIf="empresasPrincipales.length > 0">
    <mat-card *ngFor="let empresa of empresasPrincipales" class="empresa-card">
      <!-- Header de la Empresa -->
      <mat-card-header>
        <div class="empresa-header-content">
          <div class="empresa-title-section">
            <div class="tenant-badge">
              <mat-icon>domain</mat-icon>
              <strong>{{ empresa.tenantId }}</strong>
            </div>
            <div class="empresa-title">
              <h2>{{ empresa.razonSocial }}</h2>
              <p class="ruc">RUC: {{ empresa.ruc }}</p>
            </div>
          </div>
          <div class="empresa-actions">
            <button mat-icon-button color="primary" (click)="openEmpresaDialog(empresa)"
                    matTooltip="Editar empresa">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="accent" (click)="viewEmpresaDetail(empresa)"
                    matTooltip="Ver detalle">
              <mat-icon>visibility</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteEmpresa(empresa)"
                    matTooltip="Eliminar empresa">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>
      </mat-card-header>

      <!-- Información de la Empresa -->
      <mat-card-content>
        <div class="empresa-info-grid">
          <div class="info-item">
            <mat-icon>location_on</mat-icon>
            <div>
              <label>Dirección</label>
              <span>{{ empresa.direccion }}</span>
            </div>
          </div>
          <div class="info-item">
            <mat-icon>phone</mat-icon>
            <div>
              <label>Teléfono</label>
              <span>{{ empresa.telefono }}</span>
            </div>
          </div>
          <div class="info-item">
            <mat-icon>email</mat-icon>
            <div>
              <label>Email</label>
              <span>{{ empresa.email }}</span>
            </div>
          </div>
          <div class="info-item">
            <mat-icon>stars</mat-icon>
            <div>
              <label>Plan</label>
              <mat-chip [class.chip-enterprise]="empresa.plan === 'ENTERPRISE'"
                        [class.chip-free]="empresa.plan === 'FREE'">
                {{ empresa.plan }}
              </mat-chip>
            </div>
          </div>
          <div class="info-item">
            <mat-icon>location_city</mat-icon>
            <div>
              <label>Sedes</label>
              <span>{{ empresa.cantidadSedes }}</span>
            </div>
          </div>
          <div class="info-item">
            <mat-icon>verified</mat-icon>
            <div>
              <label>Estado</label>
              <mat-chip [class.chip-activo]="empresa.estado === 'ACTIVO'"
                        [class.chip-inactivo]="empresa.estado !== 'ACTIVO'">
                {{ empresa.estado }}
              </mat-chip>
            </div>
          </div>
        </div>

        <!-- Sedes -->
        <div class="sedes-section">
          <div class="sedes-header">
            <h3>
              <mat-icon>location_on</mat-icon>
              Sedes
            </h3>
            <button mat-raised-button color="primary" (click)="openSedeDialog(empresa)">
              <mat-icon>add</mat-icon>
              Nueva Sede
            </button>
          </div>

          <div class="sedes-grid" *ngIf="empresa.sedes && empresa.sedes.length > 0">
            <div *ngFor="let sede of empresa.sedes" class="sede-item">
              <div class="sede-content">
                <div class="sede-info">
                  <mat-icon *ngIf="sede.esPrincipal" class="star-icon">star</mat-icon>
                  <div class="sede-details">
                    <strong>{{ sede.nombre }}</strong>
                    <small>{{ sede.direccion }}</small>
                  </div>
                </div>
                <div class="sede-badges">
                  <mat-chip [class.chip-principal]="sede.esPrincipal"
                            [class.chip-sucursal]="!sede.esPrincipal">
                    {{ sede.esPrincipal ? 'Principal' : 'Sucursal' }}
                  </mat-chip>
                  <mat-chip [class.chip-activo]="sede.activo"
                            [class.chip-inactivo]="!sede.activo">
                    {{ sede.activo ? 'Activo' : 'Inactivo' }}
                  </mat-chip>
                </div>
              </div>
              <div class="sede-actions">
                <button mat-icon-button color="primary" (click)="openSedeDialog(empresa, sede)"
                        matTooltip="Editar sede">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteSede(empresa, sede)"
                        matTooltip="Eliminar sede"
                        [disabled]="sede.esPrincipal">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          </div>

          <div *ngIf="!empresa.sedes || empresa.sedes.length === 0" class="no-sedes">
            <mat-icon>domain_disabled</mat-icon>
            <p>No hay sedes registradas para esta empresa</p>
            <button mat-raised-button color="primary" (click)="openSedeDialog(empresa)">
              <mat-icon>add</mat-icon>
              Agregar Primera Sede
            </button>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Estado vacío -->
  <mat-card *ngIf="empresasPrincipales.length === 0" class="empty-state">
    <mat-icon>domain_disabled</mat-icon>
    <h3>No hay empresas principales registradas</h3>
    <p>Comienza creando tu primera empresa principal para gestionar sus sedes y configuración.</p>
    <button mat-raised-button color="primary" (click)="openEmpresaDialog()">
      <mat-icon>add_business</mat-icon>
      Crear Primera Empresa Principal
    </button>
  </mat-card>
</div>
